<Project Sdk="Microsoft.NET.Sdk">

  <PropertyGroup>
    <TargetFrameworks>net48;net8.0</TargetFrameworks>
    <GenerateAssemblyInfo>false</GenerateAssemblyInfo>
    <ImplicitUsings>false</ImplicitUsings>
    <NoWarn>2008</NoWarn>
  </PropertyGroup>

  <PropertyGroup Condition="'$(TargetFramework)' == 'net8.0'">
    <RestorePackagesWithLockFile>true</RestorePackagesWithLockFile>
    <CopyLocalLockFileAssemblies>true</CopyLocalLockFileAssemblies>
  </PropertyGroup>

  <ItemGroup>
    <PackageReference Include="Microsoft.Identity.Client" Version="4.*" />
    <PackageReference Include="Microsoft.IdentityModel.Abstractions" Version="8.*" />
    <PackageReference Include="Microsoft.IdentityModel.Logging" Version="8.*" />
    <PackageReference Include="Microsoft.IdentityModel.JsonWebTokens" Version="8.*" />
    <PackageReference Include="Microsoft.IdentityModel.Tokens" Version="8.*" />
    <PackageReference Include="System.IdentityModel.Tokens.Jwt" Version="8.*" />
  </ItemGroup>

  <!--
    NOTE: Some transitive dependencies (System.Diagnostics.DiagnosticSource 6.x,
    Microsoft.Identity.Client 4.x newer versions) contain types that depend on APIs
    not available in .NET Framework 4.8 runtime, causing ReflectionTypeLoadException.

    These assemblies fail to load in Windows PowerShell but don't impact core functionality.
    Use Import-DPLibrary -SkipProblematicAssemblies to suppress warnings in Windows PowerShell.

    This is a known limitation of using modern packages with net48 TFM.
    All assemblies load successfully in PowerShell Core (net8.0).
  -->

</Project>
